<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>여러개 마커 표시하기</title>
  <link rel="stylesheet" href="css/maplist.css"></link>
</head>
<body>
<div id="container">
  <div id="map" style="width:100%;height:350px;"></div>
  <div id="container_2">
    <div id="top">
      <div id="top_text">
        <h2>여성 전용 시설 찾기</h2>
        <p>내 위치</p>
        <p style="color: #343434">서울 영등포구 문래로 55</p>
      </div>
      <hr />
      <div id="selectbar">
        <span>카테고리</span>
        <div id="btn_flex">
          <div id="select_btn">
            <button id="s_btn1" onclick="searchCategory('CT1')">
              <img src="img/gym.png" alt="gym">
              <span>헬스장</span>
            </button>
          </div>
          <div id="select_btn">
            <button id="s_btn2" onclick="searchCategory('HP9')">
              <img src="img/beauti.png" alt="beauti">
              <span>뷰티</span>
            </button>
          </div>
        </div>
        <div id="btn_flex">
          <div id="select_btn">
            <button id="s_btn3" onclick="searchCategory('SW8')">
              <img src="img/bath.png" alt="gym">
              <span>화장실</span>
            </button>
          </div>
          <div id="select_btn">
            <button id="s_btn4" onclick="searchCategory('HP11')">
              <img src="img/study.png" alt="gym">
              <span>독서실</span>
            </button>
          </div>
        </div>
        <div id="btn_flex">
          <div id="select_btn">
            <button id="s_btn5" onclick="searchCategory('HP12')">
              <img src="img/shower.png" alt="gym">
              <span>사우나</span>
            </button>
          </div>
          <div id="select_btn">
            <button id="s_btn6" onclick="searchCategory('HP8')">
              <img src="img/hspt.png" alt="gym">
              <span>병원</span>
            </button>
          </div>
        </div>
        <div id="btn_flex">
          <div id="select_btn">
            <button id="s_btn7" onclick="searchCategory('HP14')">
              <img src="img/bed.png" alt="gym">
              <span>주거</span>
            </button>
          </div>
          <div id="select_btn">
            <button id="s_btn8" onclick="searchCategory('HP15')">
              <img src="img/center.png" alt="center">
              <span>상담센터</span>
            </button>
          </div>
        </div>
      </div>
      <a href="filter.html" id="plus">
        <img src="img/plus.png" alt="plus">
      </a>
    </div>
  </div>
</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=03129c04f84119519fd26eb0a763b72d&libraries=services"></script>
<script>
  // 마커를 클릭하면 장소명을 표출할 인포윈도우 입니다
  var infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });

  var mapContainer = document.getElementById('map'), // 지도를 표시할 div
    mapOption = {
      center: new kakao.maps.LatLng(37.51798115945406, 126.89481840390674), // 지도의 중심좌표
      level: 6 // 지도의 확대 레벨
    };

  // 지도를 생성합니다
  var map = new kakao.maps.Map(mapContainer, mapOption);

  // 장소 검색 객체를 생성합니다
  var ps = new kakao.maps.services.Places(map);

  // 전역 변수로 마커들을 담을 배열을 선언합니다
  var markers = [];

  // 카테고리로 은행을 검색합니다
  function searchCategory(categoryCode) {
    ps.categorySearch(categoryCode, placesSearchCB, { useMapBounds: true });
  }

  // 키워드 검색 완료 시 호출되는 콜백함수 입니다
  function placesSearchCB(data, status, pagination) {
    if (status === kakao.maps.services.Status.OK) {
      // 기존 마커들을 모두 제거합니다
      removeMarker();

      for (var i = 0; i < data.length; i++) {
        displayMarker(data[i]);
      }
    }
  }

  // 지도에 마커를 표시하는 함수입니다
  function displayMarker(place) {
    // 마커를 생성하고 지도에 표시합니다
    var marker = new kakao.maps.Marker({
      map: map,
      position: new kakao.maps.LatLng(place.y, place.x)
    });

    // 마커에 클릭이벤트를 등록합니다
    kakao.maps.event.addListener(marker, 'click', function () {
      // 마커를 클릭하면 장소명이 인포윈도우에 표출됩니다
      infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
      infowindow.open(map, marker);
    });

    // 생성된 마커를 배열에 추가합니다
    markers.push(marker);
  }

  // 지도에서 기존에 표시한 마커들을 모두 제거하는 함수입니다
  function removeMarker() {
    for (var i = 0; i < markers.length; i++) {
      markers[i].setMap(null);
    }
    // 배열을 비워줍니다
    markers = [];
  }
</script>
</body>
</html>
